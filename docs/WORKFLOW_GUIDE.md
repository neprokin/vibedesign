# Руководство по рабочим процессам

Этот документ описывает типовые рабочие процессы и сценарии использования MCP-сервера и Figma-плагина для решения практических задач дизайна и разработки.

## Содержание

1. [Общий процесс работы](#общий-процесс-работы)
2. [Настройка и запуск](#настройка-и-запуск)
3. [Рабочий процесс: От идеи к коду](#рабочий-процесс-от-идеи-к-коду)
4. [Рабочий процесс: Аудит дизайн-системы](#рабочий-процесс-аудит-дизайн-системы)
5. [Рабочий процесс: Адаптация макета для мобильных устройств](#рабочий-процесс-адаптация-макета-для-мобильных-устройств)
6. [Рабочий процесс: Улучшение доступности](#рабочий-процесс-улучшение-доступности)
7. [Тестирование интеграции](#тестирование-интеграции)
8. [Советы по оптимизации рабочего процесса](#советы-по-оптимизации-рабочего-процесса)

## Общий процесс работы

Большинство рабочих процессов следуют одному и тому же базовому шаблону:

1. **Подготовка**: Открыть Figma и запустить MCP-сервер
2. **Выбор**: Выбрать элементы дизайна для работы
3. **Действие**: Использовать соответствующий инструмент в плагине
4. **Результат**: Получить результат и применить его
5. **Итерация**: Внести изменения и при необходимости повторить процесс

## Настройка и запуск

Перед началом работы необходимо настроить и запустить все компоненты системы.

### Запуск MCP-сервера

1. Откройте терминал и перейдите в директорию MCP-сервера:
   ```bash
   cd path/to/project/mcp_server
   ```

2. Активируйте виртуальное окружение (если используется):
   ```bash
   # Linux/macOS
   source venv/bin/activate
   # Windows
   venv\Scripts\activate
   ```

3. Запустите MCP-сервер:
   ```bash
   python server.py
   ```

4. Убедитесь, что сервер успешно запущен и ожидает соединения:
   ```
   [INFO] MCP-сервер запущен на ws://localhost:8765
   [INFO] Ожидание подключений...
   ```

### Загрузка плагина в Figma

1. Запустите Figma Desktop.

2. Загрузите плагин в режиме разработки:
   - Перейдите в меню: `Plugins > Development > New Plugin...`
   - Выберите опцию `Link existing plugin`
   - Укажите путь к файлу `manifest.json` в папке `figma_plugin`

3. Запустите плагин:
   - Перейдите в меню: `Plugins > Development > Vibe Design`
   - При первом запуске может потребоваться подтверждение разрешений

4. Подключитесь к MCP-серверу:
   - В открывшемся интерфейсе плагина нажмите кнопку "Connect"
   - Проверьте, что статус соединения изменился на "Connected"

## Рабочий процесс: От идеи к коду

Этот процесс позволяет быстро превратить дизайн-концепцию в готовый код компонента.

### Шаг 1: Создание прототипа компонента

1. В Figma создайте новый фрейм (Shortcut: F)
2. Создайте свой компонент, используя базовые элементы (прямоугольники, текст, иконки)
3. Добавьте стили и эффекты для улучшения визуального представления
4. (Опционально) Создайте несколько состояний компонента (hover, active, disabled)

### Шаг 2: Анализ компонента

1. Запустите MCP-сервер (`cd mcp_server && python server.py`)
2. Откройте Figma-плагин
3. Выберите созданный компонент
4. В плагине выберите инструмент "Analyze Design"
5. Получите анализ и рекомендации по улучшению компонента:
   - Соответствие дизайн-системе
   - Согласованность стилей
   - Доступность (контраст, размеры и т.д.)

### Шаг 3: Улучшение дизайна на основе рекомендаций

1. Внесите изменения в дизайн на основе рекомендаций
2. Повторите анализ, чтобы убедиться, что улучшения эффективны
3. Финализируйте дизайн компонента

### Шаг 4: Генерация кода

1. Выберите финальную версию компонента
2. В плагине выберите инструмент "Generate Code"
3. Выберите целевой фреймворк:
   - React
   - Vue
   - HTML/CSS
4. Настройте дополнительные параметры (при необходимости):
   - Стилевая система (CSS, Tailwind, Styled Components)
   - Типизация (JavaScript/TypeScript)
   - Интерактивность
5. Нажмите "Generate"
6. Получите готовый код компонента

### Шаг 5: Интеграция в проект

1. Скопируйте сгенерированный код
2. Вставьте его в свой проект
3. При необходимости, внесите корректировки вручную
4. Протестируйте компонент в реальных условиях

**Время выполнения**: ~30-45 минут (включая итерации)

## Рабочий процесс: Аудит дизайн-системы

Этот процесс помогает выявить несоответствия и проблемы в существующей дизайн-системе.

### Шаг 1: Подготовка дизайн-системы для анализа

1. Откройте файл с дизайн-системой в Figma
2. Убедитесь, что все элементы правильно организованы (цвета, типографика, компоненты)
3. Запустите MCP-сервер и откройте плагин

### Шаг 2: Анализ дизайн-системы

1. Выберите страницу или фрейм с дизайн-системой
2. В плагине выберите инструмент "Analyze Design System"
3. Нажмите "Run Analysis"
4. Получите отчет о состоянии дизайн-системы:
   - Согласованность цветов
   - Использование типографики
   - Соответствие принципам оформления
   - Доступность (контраст, читабельность)
   - Проблемы в компонентах

### Шаг 3: Выявление и исправление проблем

1. Просмотрите отчет и выделите основные проблемы
2. Создайте план исправления найденных проблем
3. Для каждой проблемы:
   - Внесите необходимые изменения в дизайн-систему
   - Выполните повторный анализ, чтобы убедиться в исправлении

### Шаг 4: Документирование изменений

1. Создайте документацию изменений, внесенных в дизайн-систему
2. Обновите руководство по использованию дизайн-системы
3. Оповестите команду об изменениях

**Время выполнения**: ~2-4 часа (в зависимости от размера дизайн-системы)

## Рабочий процесс: Адаптация макета для мобильных устройств

Этот процесс помогает быстро адаптировать настольные макеты для мобильных устройств.

### Шаг 1: Подготовка десктопного макета

1. Откройте файл с десктопным макетом в Figma
2. Убедитесь, что макет правильно структурирован и использует компоненты
3. Запустите MCP-сервер и откройте плагин

### Шаг 2: Генерация мобильных макетов

1. Выберите фрейм с десктопным макетом
2. В плагине выберите инструмент "Generate Responsive Layout"
3. Выберите целевое разрешение:
   - Tablet (768px)
   - Mobile Large (425px)
   - Mobile Small (320px)
4. Настройте дополнительные параметры (при необходимости):
   - Стратегия адаптации (stack, shrink, reflow)
   - Сохранение пропорций
   - Минимальные размеры элементов
5. Нажмите "Generate"
6. Получите адаптивную версию макета

### Шаг 3: Корректировка адаптивного макета

1. Просмотрите сгенерированный макет
2. Внесите необходимые корректировки вручную:
   - Позиционирование элементов
   - Размеры шрифтов
   - Отступы и интервалы
3. Протестируйте макет на различных устройствах (через режим "Device Preview" в Figma)

### Шаг 4: Финализация и документирование

1. Сохраните финальные версии адаптивных макетов
2. Создайте документацию по адаптивной версии:
   - Основные правила адаптации
   - Изменения в компоновке
   - Особые случаи и исключения

**Время выполнения**: ~1-2 часа (в зависимости от сложности макета)

## Рабочий процесс: Улучшение доступности

Этот процесс помогает выявить и исправить проблемы доступности в дизайне.

### Шаг 1: Аудит доступности

1. Откройте файл с дизайном в Figma
2. Выберите фрейм или компонент для проверки
3. Запустите MCP-сервер и откройте плагин
4. В плагине выберите инструмент "Analyze Accessibility"
5. Нажмите "Run Analysis"
6. Получите отчет о проблемах доступности:
   - Контраст текста
   - Размер активных элементов
   - Альтернативный текст
   - Порядок фокусировки
   - Семантические роли

### Шаг 2: Исправление проблем доступности

1. Изучите отчет и выделите критические проблемы
2. Для каждой проблемы:
   - Внесите необходимые изменения в дизайн
   - Повторно проверьте доступность
3. Особое внимание уделите:
   - Цветовому контрасту (WCAG AA/AAA)
   - Размерам интерактивных элементов (минимум 44x44 px)
   - Альтернативному тексту для изображений

### Шаг 3: Документирование правил доступности

1. Создайте руководство по доступности для проекта
2. Включите в руководство лучшие практики и требования
3. Добавьте примеры правильных и неправильных решений
4. Поделитесь руководством с командой

**Время выполнения**: ~1-3 часа (в зависимости от объема и сложности дизайна)

## Тестирование интеграции

Этот процесс помогает проверить правильность работы интеграции между плагином Figma и MCP-сервером.

### Шаг 1: Подготовка среды

1. Запустите MCP-сервер:
     ```bash
     cd mcp_server
   python server.py
   ```

2. Запустите плагин в Figma:
   - Откройте Figma Desktop
   - Перейдите в меню: Plugins > Development > Vibe Design
   - Если плагин еще не установлен, выполните установку (см. раздел "Настройка и запуск")

3. Откройте консоль разработчика:
   - В открытом плагине нажмите правой кнопкой мыши и выберите "Inspect Element"
   - Перейдите на вкладку "Console"

### Шаг 2: Проверка соединения

1. В интерфейсе плагина нажмите кнопку "Connect"
2. Проверьте статус соединения:
   - В интерфейсе плагина индикатор должен изменить цвет на зеленый
   - В консоли разработчика должно появиться сообщение "WebSocket connected"
   - В логах MCP-сервера должно появиться сообщение о новом подключении

3. Проверка отключения и переподключения:
   - Нажмите "Reconnect" в плагине и убедитесь, что соединение переустанавливается
   - Остановите MCP-сервер (Ctrl+C) и убедитесь, что индикатор в плагине становится красным
   - Перезапустите MCP-сервер и переподключитесь

### Шаг 3: Проверка инструментов

1. **Тест анализа дизайна**:
   - Создайте или выберите элемент в Figma
   - Выберите инструмент "Analyze Design"
   - Настройте параметры и нажмите "Run Analysis"
   - Проверьте в консоли отправляемые и получаемые данные
   - Убедитесь, что результат анализа отображается в плагине

2. **Тест генерации кода**:
   - Выберите компонент в Figma
   - Выберите инструмент "Generate Code"
   - Настройте параметры и нажмите "Generate Code"
   - Проверьте в консоли отправляемые и получаемые данные
   - Убедитесь, что сгенерированный код отображается в плагине

3. **Тест генерации адаптивных макетов**:
   - Выберите фрейм в Figma
   - Выберите инструмент "Responsive Layout"
   - Настройте параметры и нажмите "Generate Responsive Layout"
   - Проверьте в консоли отправляемые и получаемые данные
   - Убедитесь, что в Figma создаются адаптивные версии макета

4. **Тест генерации вариантов**:
   - Выберите компонент или создайте новое описание
   - Выберите инструмент "Create Variants"
   - Настройте параметры и нажмите "Generate Variants"
   - Проверьте в консоли отправляемые и получаемые данные
   - Убедитесь, что варианты отображаются в плагине

### Шаг 4: Проверка обработки ошибок

1. Проверка отсутствия выбранных элементов:
   - Снимите выделение со всех элементов в Figma
   - Попробуйте запустить любой инструмент
   - Убедитесь, что выводится понятное сообщение об ошибке

2. Проверка отключенного сервера:
   - Остановите MCP-сервер
   - Попробуйте запустить любой инструмент
   - Убедитесь, что выводится понятное сообщение об ошибке соединения

3. Проверка некорректных данных:
   - Выберите элемент неподдерживаемого типа (например, линию для генерации кода)
   - Убедитесь, что выводится понятное сообщение об ошибке

**Время выполнения**: ~30-60 минут

## Советы по оптимизации рабочего процесса

### Организация фреймов и слоев

1. **Именование**: Используйте понятные и последовательные имена для фреймов и слоев
2. **Группировка**: Объединяйте связанные элементы в группы
3. **Компоненты**: Используйте компоненты для повторяющихся элементов
4. **Авто-компоновка**: Применяйте авто-компоновку (Auto Layout) для упрощения адаптивности

### Оптимизация промптов

1. **Специфичность**: Используйте конкретные запросы вместо общих
2. **Контекст**: Предоставляйте достаточно контекста для получения качественных результатов
3. **Итерации**: Не бойтесь выполнять несколько итераций для достижения лучшего результата
4. **Кастомизация**: Настраивайте шаблоны промптов под свои конкретные задачи

### Работа в команде

1. **Шеринг**: Используйте Figma Comments для обсуждения изменений
2. **Документация**: Документируйте решения и изменения
3. **Версионирование**: Создавайте версии макетов перед значительными изменениями
4. **Обратная связь**: Регулярно собирайте обратную связь от разработчиков и дизайнеров

### Оптимизация использования API

1. **Кэширование**: Используйте кэширование для повторяющихся запросов
2. **Batch-запросы**: Объединяйте несколько операций в один запрос
3. **Оптимизация токенов**: Минимизируйте количество токенов в промптах
4. **Мониторинг**: Отслеживайте использование API и расходы

### Отладка и устранение проблем

1. **Логирование**: Включите расширенное логирование в MCP-сервере для отладки
2. **Консоль разработчика**: Используйте консоль в плагине для мониторинга сообщений
3. **Изолированное тестирование**: Тестируйте каждый инструмент отдельно
4. **Поэтапный подход**: При возникновении проблем разделите процесс на этапы и определите, на каком из них возникает ошибка

---

Следуя этим рабочим процессам и советам, вы сможете максимально эффективно использовать возможности MCP-сервера и Figma-плагина для улучшения дизайна и ускорения разработки. 